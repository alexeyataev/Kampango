<?xml version="1.0" encoding="UTF-8"?>
<Workflow xmlns="http://soap.sforce.com/2006/04/metadata">
    <alerts>
        <fullName>Course_Assignment_Rejection</fullName>
        <description>Course Assignment Rejection</description>
        <protected>false</protected>
        <recipients>
            <type>creator</type>
        </recipients>
        <senderAddress>nctcourses@nct.org.uk</senderAddress>
        <senderType>OrgWideEmailAddress</senderType>
        <template>NCT_Templates/Course_Assignment_Rejected</template>
    </alerts>
    <alerts>
        <fullName>Send_Email_When_CAD_Invalidated</fullName>
        <description>Send Email When CAD Invalidated</description>
        <protected>false</protected>
        <recipients>
            <type>owner</type>
        </recipients>
        <senderAddress>nctcourses@nct.org.uk</senderAddress>
        <senderType>OrgWideEmailAddress</senderType>
        <template>NCT_Templates/Inform_Practitioner_When_CAD_Invalidated</template>
    </alerts>
    <alerts>
        <fullName>Send_Email_When_CAD_Withdrawn</fullName>
        <description>Send Email When CAD Withdrawn</description>
        <protected>false</protected>
        <recipients>
            <type>owner</type>
        </recipients>
        <senderAddress>nctcourses@nct.org.uk</senderAddress>
        <senderType>OrgWideEmailAddress</senderType>
        <template>NCT_Templates/Inform_Practitioner_When_CAD_Withdrawn</template>
    </alerts>
    <fieldUpdates>
        <fullName>Set_Course_Assignment_Status_Invalidated</fullName>
        <field>Status__c</field>
        <literalValue>Invalidated</literalValue>
        <name>Set Course Assignment Status Invalidated</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>UpdateStatusToApproved</fullName>
        <field>Status__c</field>
        <literalValue>Approved</literalValue>
        <name>UpdateStatusToApproved</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>UpdateStatusToRejected</fullName>
        <field>Status__c</field>
        <literalValue>Rejected</literalValue>
        <name>UpdateStatusToRejected</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>UpdateStatusToSubmitted</fullName>
        <field>Status__c</field>
        <literalValue>Submitted</literalValue>
        <name>UpdateStatusToSubmitted</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Literal</operation>
        <protected>false</protected>
    </fieldUpdates>
    <rules>
        <fullName>InformPractitionerWhenCADInvalidated</fullName>
        <actions>
            <name>Send_Email_When_CAD_Invalidated</name>
            <type>Alert</type>
        </actions>
        <active>true</active>
        <criteriaItems>
            <field>Course_Assignment__c.Status__c</field>
            <operation>equals</operation>
            <value>Invalidated</value>
        </criteriaItems>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
    </rules>
    <rules>
        <fullName>InformPractitionerWhenCADWithdrawn</fullName>
        <actions>
            <name>Send_Email_When_CAD_Withdrawn</name>
            <type>Alert</type>
        </actions>
        <active>true</active>
        <criteriaItems>
            <field>Course_Assignment__c.Status__c</field>
            <operation>equals</operation>
            <value>Withdrawn</value>
        </criteriaItems>
        <triggerType>onCreateOrTriggeringUpdate</triggerType>
    </rules>
    <rules>
        <fullName>Invalidate Course Assignment If Fees Change</fullName>
        <actions>
            <name>Set_Course_Assignment_Status_Invalidated</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <description>If the Practitioner Fees on a Submitted, Approved or Rejected CA record change for any reason, the CA record should be invalidated.</description>
        <formula>AND(ISCHANGED( Total_Fees__c ),
OR( ISPICKVAL( Status__c , &#39;Submitted&#39;), ISPICKVAL( Status__c , &#39;Approved&#39;), ISPICKVAL( Status__c , &#39;Rejected&#39;) ))</formula>
        <triggerType>onAllChanges</triggerType>
    </rules>
</Workflow>
