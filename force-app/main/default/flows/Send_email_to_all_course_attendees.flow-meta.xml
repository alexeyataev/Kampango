<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>Send_Email</name>
        <label>Send Email</label>
        <locationX>1147</locationX>
        <locationY>664</locationY>
        <actionName>SendHTMLEmailPlugin</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>Is_Emails_Sent_Success</targetReference>
        </connector>
        <inputParameters>
            <name>attachmentsIds</name>
            <value>
                <elementReference>attachmentsIds</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailAddresses</name>
            <value>
                <elementReference>emailAddresses</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailBodyToSend</name>
            <value>
                <elementReference>emailBodyToSend</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailSubject</name>
            <value>
                <elementReference>emailSubject</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>orgWideEmailAddress</name>
            <value>
                <elementReference>senderAddress</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>replyEmailAddress</name>
            <value>
                <elementReference>replyToAddress</elementReference>
            </value>
        </inputParameters>
        <outputParameters>
            <assignToReference>Email_Error</assignToReference>
            <name>errors</name>
        </outputParameters>
        <outputParameters>
            <assignToReference>Email_Is_Success</assignToReference>
            <name>isSuccess</name>
        </outputParameters>
    </actionCalls>
    <assignments>
        <name>Add_External_User_Signature</name>
        <label>Add External User Signature</label>
        <locationX>792</locationX>
        <locationY>597</locationY>
        <assignmentItems>
            <assignToReference>emailBodyToSend</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>emailBody</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>emailBodyToSend</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>externalUserSignature</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Trough_Bookings</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_Internal_User_Signature</name>
        <label>Add Internal User Signature</label>
        <locationX>802</locationX>
        <locationY>385</locationY>
        <assignmentItems>
            <assignToReference>emailBodyToSend</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>emailBody</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>emailBodyToSend</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>internalUserSignature</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Trough_Bookings</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_Partner_Contact_Email_To_Email_List</name>
        <label>Add Partner Contact Email To Email List</label>
        <locationX>1731</locationX>
        <locationY>697</locationY>
        <assignmentItems>
            <assignToReference>emailAddresses</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Loop_Trough_Bookings.Email_Partner__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Fill_Partner_Contact_Task_Details</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_Partner_Contact_To_Contact_List</name>
        <label>Add Partner Contact To Contact List</label>
        <locationX>1578</locationX>
        <locationY>697</locationY>
        <assignmentItems>
            <assignToReference>contactRecordsList</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>contactRecord</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_Partner_Contact_Email_To_Email_List</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_Primary_Contact_Email_To_Email_List</name>
        <label>Add Primary Contact Email To Email List</label>
        <locationX>1781</locationX>
        <locationY>307</locationY>
        <assignmentItems>
            <assignToReference>emailAddresses</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Loop_Trough_Bookings.Primary_Contact_Email__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Fill_Primary_Contact_Task_Details</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_Primary_Contact_To_Contact_List</name>
        <label>Add Primary Contact To Contact List</label>
        <locationX>2040</locationX>
        <locationY>306</locationY>
        <assignmentItems>
            <assignToReference>contactRecordsList</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>contactRecord</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_Primary_Contact_Email_To_Email_List</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_Task_for_Partner_To_Task_List</name>
        <label>Add Task for Partner To Task List</label>
        <locationX>2040</locationX>
        <locationY>697</locationY>
        <assignmentItems>
            <assignToReference>tasksToCreateList</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>taskToCreate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Primary_Contact_Instance</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_Task_for_Primary_To_Task_List</name>
        <label>Add Task for Primary To Task List</label>
        <locationX>1432</locationX>
        <locationY>307</locationY>
        <assignmentItems>
            <assignToReference>tasksToCreateList</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>taskToCreate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Trough_Bookings</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Create_Partner_Contact_Instance</name>
        <label>Create Partner Contact Instance</label>
        <locationX>1428</locationX>
        <locationY>697</locationY>
        <assignmentItems>
            <assignToReference>contactRecord.Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Trough_Bookings.Partner_Contact__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>contactRecord.LastName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Trough_Bookings.Last_Name_Partner__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>contactRecord.FirstName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Trough_Bookings.First_Name_Partner__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>contactRecord.Email</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Trough_Bookings.Email_Partner__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_Partner_Contact_To_Contact_List</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Create_Primary_Contact_Instance</name>
        <label>Create Primary Contact Instance</label>
        <locationX>2040</locationX>
        <locationY>491</locationY>
        <assignmentItems>
            <assignToReference>contactRecord.Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Trough_Bookings.Primary_Contact__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>contactRecord.LastName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Trough_Bookings.Last_Name__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>contactRecord.FirstName</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Trough_Bookings.First_Name__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>contactRecord.Email</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Trough_Bookings.Primary_Contact_Email__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_Primary_Contact_To_Contact_List</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Fill_Partner_Contact_Task_Details</name>
        <label>Fill Partner Contact Task Details</label>
        <locationX>1882</locationX>
        <locationY>697</locationY>
        <assignmentItems>
            <assignToReference>taskToCreate.ActivityDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>taskToCreate.Description</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>emailBody</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>taskToCreate.IsRecurrence</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>taskToCreate.IsReminderSet</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>taskToCreate.OwnerId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Trough_Bookings.OwnerId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>taskToCreate.Priority</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Low</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>taskToCreate.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Completed</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>taskToCreate.Subject</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>emailSubject</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>taskToCreate.WhatId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Trough_Bookings.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>taskToCreate.WhoId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Trough_Bookings.Partner_Contact__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_Task_for_Partner_To_Task_List</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Fill_Primary_Contact_Task_Details</name>
        <label>Fill Primary Contact Task Details</label>
        <locationX>1601</locationX>
        <locationY>307</locationY>
        <assignmentItems>
            <assignToReference>taskToCreate.ActivityDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>taskToCreate.Description</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>emailBody</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>taskToCreate.IsRecurrence</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>taskToCreate.IsReminderSet</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>taskToCreate.OwnerId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Trough_Bookings.OwnerId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>taskToCreate.Priority</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Low</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>taskToCreate.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Completed</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>taskToCreate.Subject</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>emailSubject</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>taskToCreate.WhatId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Trough_Bookings.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>taskToCreate.WhoId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Trough_Bookings.Primary_Contact__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_Task_for_Primary_To_Task_List</targetReference>
        </connector>
    </assignments>
    <constants>
        <name>acceptedFormats</name>
        <dataType>String</dataType>
        <value>
            <stringValue>.doc, .docx, .pdf, .odt, .mp3, .mp4</stringValue>
        </value>
    </constants>
    <constants>
        <name>emptyString</name>
        <dataType>String</dataType>
        <value>
            <stringValue/>
        </value>
    </constants>
    <constants>
        <name>internalUserType</name>
        <dataType>String</dataType>
        <value>
            <stringValue>Standard</stringValue>
        </value>
    </constants>
    <constants>
        <name>ORG_WIDE_ADDRESS_VALUE</name>
        <dataType>String</dataType>
        <value>
            <stringValue>nctcourses@nct.org.uk</stringValue>
        </value>
    </constants>
    <decisions>
        <name>Check_Current_User_Type</name>
        <label>Check Current User Type</label>
        <locationX>593</locationX>
        <locationY>605</locationY>
        <defaultConnector>
            <targetReference>Add_External_User_Signature</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>External User</defaultConnectorLabel>
        <rules>
            <name>Internal_User</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>currentUserType</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>internalUserType</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Extra_Course_Data</targetReference>
            </connector>
            <label>Internal User</label>
        </rules>
    </decisions>
    <decisions>
        <name>Does_Partnet_Contact_Exist</name>
        <label>Does Partnet Contact Exist?</label>
        <locationX>1419</locationX>
        <locationY>490</locationY>
        <defaultConnector>
            <targetReference>Create_Primary_Contact_Instance</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Loop_Trough_Bookings.Partner_Contact__c</leftValueReference>
                <operator>NotEqualTo</operator>
            </conditions>
            <connector>
                <targetReference>Create_Partner_Contact_Instance</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Booking_Records_List_Empty</name>
        <label>Is Booking Records List Empty</label>
        <locationX>366</locationX>
        <locationY>606</locationY>
        <defaultConnector>
            <targetReference>Check_Current_User_Type</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Not Is Empty</defaultConnectorLabel>
        <rules>
            <name>Is_Empty</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Bookings_With_Primary_Contact_Email</leftValueReference>
                <operator>EqualTo</operator>
            </conditions>
            <connector>
                <targetReference>Bookings_Not_Found_Screeen</targetReference>
            </connector>
            <label>Is Empty</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Emails_Sent_Success</name>
        <label>Is Emails Sent Success</label>
        <locationX>1140</locationX>
        <locationY>816</locationY>
        <defaultConnector>
            <targetReference>Email_Is_Not_Sent_Screen</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Not Success</defaultConnectorLabel>
        <rules>
            <name>Success</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Email_Is_Success</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Create_Tasks</targetReference>
            </connector>
            <label>Success</label>
        </rules>
    </decisions>
    <formulas>
        <name>currentUserEmail</name>
        <dataType>String</dataType>
        <expression>{!$User.Email}</expression>
    </formulas>
    <formulas>
        <name>currentUserName</name>
        <dataType>String</dataType>
        <expression>{!$User.FirstName} &amp; &apos; &apos; &amp; {!$User.LastName}</expression>
    </formulas>
    <formulas>
        <name>currentUserType</name>
        <dataType>String</dataType>
        <expression>TEXT({!$User.UserType})</expression>
    </formulas>
    <formulas>
        <name>replyToAddress</name>
        <dataType>String</dataType>
        <expression>IF({!currentUserType} == {!internalUserType}, {!ORG_WIDE_ADDRESS_VALUE}, {!$User.Email})</expression>
    </formulas>
    <formulas>
        <name>senderAddress</name>
        <dataType>String</dataType>
        <expression>IF({!currentUserType} == {!internalUserType}, {!ORG_WIDE_ADDRESS_VALUE}, &apos;&apos;)</expression>
    </formulas>
    <interviewLabel>Send email to all course attendees {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Send email to all course attendees</label>
    <loops>
        <name>Loop_Trough_Bookings</name>
        <label>Loop Trough Bookings</label>
        <locationX>1148</locationX>
        <locationY>488</locationY>
        <collectionReference>bookingsWithPrimaryContactEmail</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Does_Partnet_Contact_Exist</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Send_Email</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>Flow</processType>
    <recordCreates>
        <name>Create_Tasks</name>
        <label>Create Tasks</label>
        <locationX>992</locationX>
        <locationY>807</locationY>
        <connector>
            <targetReference>Course_Attendees_Table_Screen</targetReference>
        </connector>
        <inputReference>tasksToCreateList</inputReference>
    </recordCreates>
    <recordLookups>
        <name>Get_Bookings_With_Primary_Contact_Email</name>
        <label>Get Bookings With Primary Contact Email</label>
        <locationX>175</locationX>
        <locationY>604</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Is_Booking_Records_List_Empty</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Error_Handler_Flow</targetReference>
        </faultConnector>
        <filters>
            <field>Course__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </filters>
        <filters>
            <field>Do_Not_Contact__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <filters>
            <field>Status__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Confirmed</stringValue>
            </value>
        </filters>
        <object>Booking__c</object>
        <outputReference>bookingsWithPrimaryContactEmail</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>Email_Partner__c</queriedFields>
        <queriedFields>Primary_Contact_Email__c</queriedFields>
        <queriedFields>First_Name__c</queriedFields>
        <queriedFields>Last_Name__c</queriedFields>
        <queriedFields>First_Name_Partner__c</queriedFields>
        <queriedFields>Last_Name_Partner__c</queriedFields>
        <queriedFields>Name</queriedFields>
        <queriedFields>OwnerId</queriedFields>
        <queriedFields>Primary_Contact__c</queriedFields>
        <queriedFields>Partner_Contact__c</queriedFields>
        <sortField>Name</sortField>
        <sortOrder>Asc</sortOrder>
    </recordLookups>
    <recordLookups>
        <name>Get_Extra_Course_Data</name>
        <label>Get Extra Course Data</label>
        <locationX>602</locationX>
        <locationY>385</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Add_Internal_User_Signature</targetReference>
        </connector>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </filters>
        <object>Course__c</object>
        <outputReference>courseRecord</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>Enquiries_PSA_Email__c</queriedFields>
        <queriedFields>Enquiries_PSA_Name__c</queriedFields>
        <queriedFields>Enquiries_PSA_Phone__c</queriedFields>
    </recordLookups>
    <runInMode>SystemModeWithoutSharing</runInMode>
    <screens>
        <name>Bookings_Not_Found_Screeen</name>
        <label>Bookings Not Found Screeen</label>
        <locationX>372</locationX>
        <locationY>803</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>Bookings_Not_Found_Message</name>
            <fieldText>&lt;p&gt;&lt;b style=&quot;font-size: 22px;&quot;&gt;No booking records were found for this course.&lt;/b&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Course_Attendees_Table_Screen</name>
        <label>Course Attendees Table Screen</label>
        <locationX>821</locationX>
        <locationY>807</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>Course_Attendees_Table_Message</name>
            <fieldText>&lt;p style=&quot;text-align: center;&quot;&gt;&lt;span style=&quot;font-size: 20px;&quot;&gt;Email has been sent to the following attendees:&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Course_Attendees_Table_Component</name>
            <extensionName>c:courseAttendeesTable</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>contactList</name>
                <value>
                    <elementReference>contactRecordsList</elementReference>
                </value>
            </inputParameters>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
        </fields>
        <showFooter>false</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Email_details</name>
        <label>Email details</label>
        <locationX>176</locationX>
        <locationY>408</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Get_Bookings_With_Primary_Contact_Email</targetReference>
        </connector>
        <fields>
            <name>WarningMessage</name>
            <fieldText>&lt;p style=&quot;text-align: center;&quot;&gt;&lt;span style=&quot;font-size: 18px; background-color: rgb(255, 255, 255); color: rgb(29, 28, 29);&quot;&gt;This action will send an email to all confirmed course attendees - please ensure that you wish to do this before proceeding&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>emailSubject</name>
            <dataType>String</dataType>
            <fieldText>Subject</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>emailBody</name>
            <fieldText>Message</fieldText>
            <fieldType>LargeTextArea</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>attachment</name>
            <extensionName>forceContent:fileUpload</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Upload Attachment</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>recordId</name>
                <value>
                    <elementReference>recordId</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>multiple</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>title</name>
                <value>
                    <stringValue>Upload Email Attachments </stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>accept</name>
                <value>
                    <elementReference>acceptedFormats</elementReference>
                </value>
            </inputParameters>
            <isRequired>true</isRequired>
            <outputParameters>
                <assignToReference>attachmentsIds</assignToReference>
                <name>contentDocIds</name>
            </outputParameters>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Email_Is_Not_Sent_Screen</name>
        <label>Email Is Not Sent Screen</label>
        <locationX>1148</locationX>
        <locationY>1013</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>Email_Is_Not_Sent_Message</name>
            <fieldText>&lt;p style=&quot;text-align: center;&quot;&gt;&lt;b style=&quot;font-size: 26px;&quot;&gt;Sorry, email(s) was not sent &lt;/b&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>false</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <start>
        <locationX>50</locationX>
        <locationY>245</locationY>
        <connector>
            <targetReference>Email_details</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <subflows>
        <name>Error_Handler_Flow</name>
        <label>Error Handler Flow</label>
        <locationX>178</locationX>
        <locationY>807</locationY>
        <flowName>Error_Handler_Flow</flowName>
    </subflows>
    <textTemplates>
        <name>externalUserSignature</name>
        <text>&lt;br&gt;&lt;br&gt;
Kind Regards,&lt;br&gt;&lt;br&gt;
{!currentUserName}&lt;br&gt;
{!currentUserEmail}</text>
    </textTemplates>
    <textTemplates>
        <name>internalUserSignature</name>
        <text>&lt;br&gt;&lt;br&gt;
Kind Regards,&lt;br&gt;&lt;br&gt;
{!courseRecord.Enquiries_PSA_Name__c}&lt;br&gt;
Course Organiser&lt;br&gt;
Telephone: {!courseRecord.Enquiries_PSA_Phone__c}&lt;br&gt;
Email: Any reply to this email should be sent to {!courseRecord.Enquiries_PSA_Email__c}</text>
    </textTemplates>
    <textTemplates>
        <name>newLine</name>
        <text>{!emptyString}
{!emptyString}</text>
    </textTemplates>
    <variables>
        <name>attachmentsIds</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>bookingsWithPrimaryContactEmail</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Booking__c</objectType>
    </variables>
    <variables>
        <name>contactRecord</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Contact</objectType>
    </variables>
    <variables>
        <name>contactRecordsList</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Contact</objectType>
    </variables>
    <variables>
        <name>courseRecord</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Course__c</objectType>
    </variables>
    <variables>
        <name>Email_Error</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>Email_Is_Success</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </variables>
    <variables>
        <name>emailAddresses</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>emailBodyToSend</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>emptyCollectionVariable</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>recipients</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>recordId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>tasksToCreateList</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Task</objectType>
    </variables>
    <variables>
        <name>taskToCreate</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Task</objectType>
    </variables>
</Flow>
