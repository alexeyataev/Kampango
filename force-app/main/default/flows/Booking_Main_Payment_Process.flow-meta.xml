<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <description>If returned false then to Client will give the ability to chose another variant payment.</description>
        <name>Add_Bank_Details_For_Membership_Handler</name>
        <label>Add Bank Details For Membership Handler</label>
        <locationX>1188</locationX>
        <locationY>1691</locationY>
        <actionName>AddBankDetailsForMembershipHandler</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>Is_Banks_Number_True</targetReference>
        </connector>
        <faultConnector>
            <targetReference>DD_Not_Available</targetReference>
        </faultConnector>
        <inputParameters>
            <name>installment</name>
            <value>
                <elementReference>Installment_For_Payment_By_DD</elementReference>
            </value>
        </inputParameters>
        <outputParameters>
            <assignToReference>bankNumber</assignToReference>
            <name>bankDetailsNumber</name>
        </outputParameters>
        <outputParameters>
            <assignToReference>bankNumberError</assignToReference>
            <name>error</name>
        </outputParameters>
    </actionCalls>
    <actionCalls>
        <name>Card_Payment_Handler</name>
        <label>Card Payment Handler</label>
        <locationX>3192</locationX>
        <locationY>479</locationY>
        <actionName>CardPaymentHandler</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>Clear_Next_Collection_Date</targetReference>
        </connector>
        <inputParameters>
            <name>amount</name>
            <value>
                <elementReference>PaymentPlanParameters.amount</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>contactId</name>
            <value>
                <elementReference>PaymentPlanParameters.contactId</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>errorPage</name>
            <value>
                <elementReference>PaymentPlanParameters.errorPage</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>giftAidableAmount</name>
            <value>
                <elementReference>PaymentPlanParameters.giftAidableAmount</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>membershipType</name>
            <value>
                <elementReference>PaymentPlanParameters.membershipType</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>partnerContactId</name>
            <value>
                <elementReference>PaymentPlanParameters.partnerContactId</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>salesInvoiceId</name>
            <value>
                <elementReference>Create_SI_and_SI_Line_Items.Id</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>successPage</name>
            <value>
                <elementReference>PaymentPlanParameters.successPage</elementReference>
            </value>
        </inputParameters>
        <outputParameters>
            <assignToReference>paymentError</assignToReference>
            <name>error</name>
        </outputParameters>
        <outputParameters>
            <assignToReference>paymentUrl</assignToReference>
            <name>url</name>
        </outputParameters>
    </actionCalls>
    <actionCalls>
        <name>Card_Payment_Plan_Handler</name>
        <label>Card Payment Plan Handler</label>
        <locationX>3193</locationX>
        <locationY>899</locationY>
        <actionName>CardPaymentPlanHandler</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>Added_Next_Collection_Date</targetReference>
        </connector>
        <inputParameters>
            <name>amount</name>
            <value>
                <elementReference>PaymentPlanParameters.amount</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>amountRecurring</name>
            <value>
                <elementReference>PaymentPlanParameters.amountRecurring</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>contactId</name>
            <value>
                <elementReference>PaymentPlanParameters.contactId</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>errorPage</name>
            <value>
                <elementReference>PaymentPlanParameters.errorPage</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>giftAidableAmount</name>
            <value>
                <elementReference>PaymentPlanParameters.giftAidableAmount</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>membershipType</name>
            <value>
                <elementReference>PaymentPlanParameters.membershipType</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>partnerContactId</name>
            <value>
                <elementReference>PaymentPlanParameters.partnerContactId</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>paymentPlanEndDate</name>
            <value>
                <elementReference>PaymentPlanParameters.paymentPlanEndDate</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>paymentPlanStartDate</name>
            <value>
                <elementReference>PaymentPlanParameters.paymentPlanStartDate</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>salesInvoiceId</name>
            <value>
                <elementReference>Create_SI_and_SI_Line_Items.Id</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>successPage</name>
            <value>
                <elementReference>PaymentPlanParameters.successPage</elementReference>
            </value>
        </inputParameters>
        <outputParameters>
            <assignToReference>paymentError</assignToReference>
            <name>error</name>
        </outputParameters>
        <outputParameters>
            <assignToReference>paymentUrl</assignToReference>
            <name>url</name>
        </outputParameters>
    </actionCalls>
    <actionCalls>
        <name>Create_SI_and_SI_Line_Items</name>
        <label>Create SI and SI Line Items</label>
        <locationX>2301</locationX>
        <locationY>676</locationY>
        <actionName>ZumzumCreatePostSalesInvoice</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>Is_SI_is_Null</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Error_Handler_SubFlow</targetReference>
        </faultConnector>
        <inputParameters>
            <name>zumzumSalesInvoiceParameterList</name>
            <value>
                <elementReference>ZumzumSalesInvoiceParametersList</elementReference>
            </value>
        </inputParameters>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </actionCalls>
    <actionCalls>
        <description>If payment by Direct Debit not available.</description>
        <name>DD_Not_Available</name>
        <label>DD Not Available</label>
        <locationX>908</locationX>
        <locationY>1811</locationY>
        <actionName>c:showToast</actionName>
        <actionType>component</actionType>
        <connector>
            <targetReference>Payment_Options_Screen</targetReference>
        </connector>
        <inputParameters>
            <name>message</name>
            <value>
                <elementReference>DD_NOT_AVAILABLE_MESSAGE</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>type</name>
            <value>
                <elementReference>TOAST_TYPE_ERROR</elementReference>
            </value>
        </inputParameters>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </actionCalls>
    <assignments>
        <name>Add_Amount_To_Be_Paid</name>
        <label>Add Amount To Be Paid</label>
        <locationX>3562</locationX>
        <locationY>907</locationY>
        <assignmentItems>
            <assignToReference>Booking_Instance_For_Update.Booking_Journey_Payable_Amount__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Amount_To_Be_Paid</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Booking_Instance_For_Update.Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>bookingId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Booking_Record</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_Cost_Membership</name>
        <label>Add Cost Membership</label>
        <locationX>2669</locationX>
        <locationY>872</locationY>
        <assignmentItems>
            <assignToReference>PaymentPlanParameters.amount</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Membership_Amount</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Check_Membership_Options_CC</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_Course_SI_Parameter</name>
        <label>Add Course SI Parameter</label>
        <locationX>2140</locationX>
        <locationY>676</locationY>
        <assignmentItems>
            <assignToReference>ZumzumSalesInvoiceParametersList</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>CourseZumzumSalesInvoiceParameter</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_SI_and_SI_Line_Items</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_Membership_SI_Parameter</name>
        <label>Add Membership SI Parameter</label>
        <locationX>1893</locationX>
        <locationY>1021</locationY>
        <assignmentItems>
            <assignToReference>ZumzumSalesInvoiceParametersList</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>MembershipZumzumSalesInvoiceParameter</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Booking_Gift_Aid_Declaration_Flow</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_Membership_Type_and_Amount_to_Installment_1</name>
        <label>Add Membership Type and Amount to Installment_1</label>
        <locationX>1362</locationX>
        <locationY>907</locationY>
        <assignmentItems>
            <assignToReference>Membership_Amount</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>AMOUNT_48</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Payment_Method_Decision_0</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_Membership_Type_and_Amount_to_Installment_2</name>
        <label>Add Membership Type and Amount to Installment_2</label>
        <locationX>1599</locationX>
        <locationY>910</locationY>
        <assignmentItems>
            <assignToReference>Membership_Amount</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>AMOUNT_57</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Payment_Method_Decision_0</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Added_Course_Payment_By_Credit_Card</name>
        <label>Added Course Payment By Credit Card</label>
        <locationX>1247</locationX>
        <locationY>495</locationY>
        <assignmentItems>
            <assignToReference>PaymentPlanParameters.amount</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Course_Fee</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Total_Payment_Course_Assignment</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Added_Next_Collection_Date</name>
        <label>Added Next Collection Date</label>
        <locationX>3399</locationX>
        <locationY>900</locationY>
        <assignmentItems>
            <assignToReference>Booking_Instance_For_Update.Next_Collection_Date__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>PaymentPlanOptionSelected.nextCollectionDate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Payment_Link_Result</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Clear_Gift_Aid_Declaration_Filed_on_Booking_Object</name>
        <label>Clear Gift Aid Declaration Filed on Booking Object</label>
        <locationX>1646</locationX>
        <locationY>683</locationY>
        <assignmentItems>
            <assignToReference>Booking_Instance_For_Update.Gift_Aid_Declaration_Status__c</assignToReference>
            <operator>Assign</operator>
        </assignmentItems>
        <connector>
            <targetReference>Get_Course_Nominal_Account</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Clear_Next_Collection_Date</name>
        <label>Clear Next Collection Date</label>
        <locationX>3400</locationX>
        <locationY>479</locationY>
        <assignmentItems>
            <assignToReference>Booking_Instance_For_Update.Next_Collection_Date__c</assignToReference>
            <operator>Assign</operator>
        </assignmentItems>
        <connector>
            <targetReference>Payment_Link_Result</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Course_Plan_Payment_By_Credit_Card</name>
        <label>Course Plan Payment By Credit Card</label>
        <locationX>1246</locationX>
        <locationY>236</locationY>
        <assignmentItems>
            <assignToReference>PaymentPlanParameters.amountRecurring</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>PaymentPlanOptionSelected.amountRecurring</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>PaymentPlanParameters.paymentPlanStartDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>PaymentPlanOptionSelected.startDate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>PaymentPlanParameters.paymentPlanEndDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>PaymentPlanOptionSelected.endDate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>PaymentPlanParameters.amount</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>PaymentPlanOptionSelected.amountFirst</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Is_Payment_Plan_True</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Total_Payment_Course_Assignment</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Course_ZumzumSalesInvoiceParameter_Assignment</name>
        <label>Course ZumzumSalesInvoiceParameter Assignment</label>
        <locationX>2009</locationX>
        <locationY>676</locationY>
        <assignmentItems>
            <assignToReference>CourseZumzumSalesInvoiceParameter.bookingId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>bookingId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>CourseZumzumSalesInvoiceParameter.customerId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Primary_Contact.AccountId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>CourseZumzumSalesInvoiceParameter.foreignNetAmount</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Course_Fee</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>CourseZumzumSalesInvoiceParameter.nominalAccountId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>CourseNominalAccount.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>CourseZumzumSalesInvoiceParameter.productId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>CoursePlace.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>CourseZumzumSalesInvoiceParameter.taxRateId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>No_VAT.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>CourseZumzumSalesInvoiceParameter.transactionCurrencyId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>GBP.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>CourseZumzumSalesInvoiceParameter.quantity</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>CourseZumzumSalesInvoiceParameter.contactId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Primary_Contact.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>CourseZumzumSalesInvoiceParameter.courseId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>bookingRecord.Course__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_Course_SI_Parameter</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Get_Course_Fee_Assigment</name>
        <label>Get Course Fee Assigment</label>
        <locationX>678</locationX>
        <locationY>193</locationY>
        <assignmentItems>
            <assignToReference>Course_Fee</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Course_Fee</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Checking_NCT_Number_on_Contact</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Membership_ZumzumSalesInvoiceParameter_Assignment</name>
        <label>Membership ZumzumSalesInvoiceParameter Assignment</label>
        <locationX>1743</locationX>
        <locationY>1021</locationY>
        <assignmentItems>
            <assignToReference>MembershipZumzumSalesInvoiceParameter.bookingId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>bookingId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>MembershipZumzumSalesInvoiceParameter.customerId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Primary_Contact.AccountId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>MembershipZumzumSalesInvoiceParameter.foreignNetAmount</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Membership_Sales_Invoice_Amount</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>MembershipZumzumSalesInvoiceParameter.nominalAccountId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>MembershipNominalAccount.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>MembershipZumzumSalesInvoiceParameter.productId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Membership_Product_Record.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>MembershipZumzumSalesInvoiceParameter.taxRateId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>No_VAT.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>MembershipZumzumSalesInvoiceParameter.transactionCurrencyId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>GBP.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>MembershipZumzumSalesInvoiceParameter.quantity</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>MembershipZumzumSalesInvoiceParameter.contactId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Primary_Contact.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_Membership_SI_Parameter</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Installment with data for AddBankDetails. 
If AddBankDetails return BankNumber then this Installment will continue to populate (e.g Sales_Invoice, BankNumber will populate before payment Apex Action).</description>
        <name>Populate_Fields_of_Installment_Object_For_Membership</name>
        <label>Populate Fields  of Installment Object For Membership</label>
        <locationX>1188</locationX>
        <locationY>1473</locationY>
        <assignmentItems>
            <assignToReference>Installment_For_Payment_By_DD.cpm__Contact__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>bookingRecord.Primary_Contact__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Installment_For_Payment_By_DD.Account_Name__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Account_Name</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Installment_For_Payment_By_DD.Account_Number__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Account_Number</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Installment_For_Payment_By_DD.Sort_Code__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Sort_Code</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_Bank_Details_For_Membership_Handler</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Populate_Fields_of_Installment_Object_With_Bank_Number</name>
        <label>Populate Fields  of Installment Object With Bank Number</label>
        <locationX>2668</locationX>
        <locationY>478</locationY>
        <assignmentItems>
            <assignToReference>Installment_For_Payment_By_DD.Bank_Details_Number__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>bankNumber</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Installment_For_Payment_By_DD.Membership_Type__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Chosen_Membership_Result</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Installment_For_Payment_By_DD.cpm__Contact__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>bookingRecord.Primary_Contact__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Installment_For_Payment_By_DD.Sales_Invoice__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Create_SI_and_SI_Line_Items.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Installment_For_Payment_By_DD.cpm__Payment_Method__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Care Membership</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Check_Membership_Options_DD</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>1. Setting Fee for SI Line Items. If Course was paid by CC then SI Line Items must be equals  Membership Amount;
2. Setting Product For SI Line Items to &quot;Membership&quot; because the course was paid by CC;</description>
        <name>Set_Data_for_SI_Line_Items_CC</name>
        <label>Set Data for SI Line Items CC</label>
        <locationX>1646</locationX>
        <locationY>1571</locationY>
        <assignmentItems>
            <assignToReference>Membership_Sales_Invoice_Amount</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Membership_Amount</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Type_Of_Product_for_Membership</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>PRODUCT_MEMBERSHIP_CC</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_Membership_Nominal_Account</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>1. Setting Fee for SI Line Items. If Course was paid by DD then SI Line Items must be equals  0;
2. Setting Product For SI Line Items to &quot;Membership - CARE/DD&quot; because the course was paid by DD;</description>
        <name>Set_Data_for_SI_Line_Items_DD</name>
        <label>Set Data for SI Line Items DD</label>
        <locationX>2043</locationX>
        <locationY>1573</locationY>
        <assignmentItems>
            <assignToReference>Membership_Sales_Invoice_Amount</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>0.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Type_Of_Product_for_Membership</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>PRODUCT_MEMBERSHIP_DD</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_Membership_Nominal_Account</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Membership_Data_for_Installment_By_CC</name>
        <label>Set Membership Data for Installment By CC</label>
        <locationX>1498</locationX>
        <locationY>1572</locationY>
        <assignmentItems>
            <assignToReference>PaymentPlanParameters.membershipType</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Chosen_Membership_Result</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>PaymentPlanParameters.giftAidableAmount</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Membership_Amount</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Set_Data_for_SI_Line_Items_CC</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Partner_Contact_Id_for_Installment</name>
        <label>Set Partner Contact Id for Installment</label>
        <locationX>3007</locationX>
        <locationY>896</locationY>
        <assignmentItems>
            <assignToReference>PaymentPlanParameters.partnerContactId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>bookingRecord.Partner_Contact__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Type_Of_Payment</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Partner_Contact_Id_for_Installment_0</name>
        <label>Set Partner Contact Id for Installment</label>
        <locationX>3009</locationX>
        <locationY>317</locationY>
        <assignmentItems>
            <assignToReference>Installment_For_Payment_By_DD.Partner_Contact__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>bookingRecord.Partner_Contact__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Membership_Installment</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Total_Amount</name>
        <label>Set Total Amount</label>
        <locationX>3736</locationX>
        <locationY>776</locationY>
        <assignmentItems>
            <assignToReference>Total_Fee</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>PaymentPlanParameters.amount</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Payment_Details_Screen</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Total_Payment_Course_Assignment</name>
        <label>Total Payment Course Assignment</label>
        <locationX>1492</locationX>
        <locationY>361</locationY>
        <assignmentItems>
            <assignToReference>PaymentPlanParameters.contactId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>bookingRecord.Primary_Contact__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Payment_Method</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>CREDIT_CARD</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>PaymentPlanParameters.successPage</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>SUCCESS_PAGE</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>PaymentPlanParameters.errorPage</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>ERROR_PAGE</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_Primary_Contact</targetReference>
        </connector>
    </assignments>
    <choices>
        <name>CourseCC</name>
        <choiceText>&lt;span style=&quot;color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); font-size: 14px;&quot;&gt;One-off payment of {!Course_Fee}&lt;/span&gt;</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Course__CC</stringValue>
        </value>
    </choices>
    <choices>
        <name>CoursePlanCC</name>
        <choiceText>&lt;span style=&quot;font-size: 14px; color: rgb(0, 0, 0);&quot;&gt;Pay by instalments&lt;/span&gt;</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>PlanCC</stringValue>
        </value>
    </choices>
    <choices>
        <name>DD_48_Every_12_Month</name>
        <choiceText>&lt;span style=&quot;color: rgb(33, 37, 41); font-size: 14px; background-color: rgb(255, 255, 255);&quot;&gt;Standard 1-year Direct Debit option - £12 a quarter - £48&lt;/span&gt;</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>DD_48_12</stringValue>
        </value>
    </choices>
    <choices>
        <name>DD_57_Every_18_Month</name>
        <choiceText>&lt;span style=&quot;color: rgb(33, 37, 41); font-size: 14px; background-color: rgb(255, 255, 255);&quot;&gt;Value 18-month Direct Debit option - £9.50 a quarter - £57&lt;/span&gt;</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>DD_57_18</stringValue>
        </value>
    </choices>
    <choices>
        <name>Debit_and_Credit_Card_Course</name>
        <choiceText>{!Credit_Card_Icon}</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>CC</stringValue>
        </value>
    </choices>
    <choices>
        <name>Debit_and_Credit_Card_Membership</name>
        <choiceText>{!Credit_Card_Icon}</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>CC</stringValue>
        </value>
    </choices>
    <choices>
        <name>Direct_Debit_Membership</name>
        <choiceText>{!Debit_Credit_Icon}</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>DD</stringValue>
        </value>
    </choices>
    <choices>
        <name>Membership_12</name>
        <choiceText>&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt;{!Membership_12_Template}&lt;/span&gt;</choiceText>
        <dataType>String</dataType>
        <value>
            <elementReference>MEMBERSHIP_TYPE_A</elementReference>
        </value>
    </choices>
    <choices>
        <name>Membership_18</name>
        <choiceText>&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt;{!Membership_18_Template}&lt;/span&gt;</choiceText>
        <dataType>String</dataType>
        <value>
            <elementReference>MEMBERSHIP_TYPE_E</elementReference>
        </value>
    </choices>
    <choices>
        <name>Membership_One_off_Payment_48</name>
        <choiceText>&lt;span style=&quot;color: rgb(33, 37, 41); font-size: 14px; background-color: rgb(255, 255, 255);&quot;&gt;Standard 1-year single payment option - £48&lt;/span&gt;</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Membership_CC_48</stringValue>
        </value>
    </choices>
    <choices>
        <name>Membership_One_off_Payment_57</name>
        <choiceText>&lt;span style=&quot;color: rgb(0, 0, 0); font-size: 14px; background-color: rgb(255, 255, 255);&quot;&gt;Value 18-month single payment option - £57&lt;/span&gt;</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Membership_CC_57</stringValue>
        </value>
    </choices>
    <choices>
        <name>Membership_Options_Joint</name>
        <choiceText>&lt;span style=&quot;font-size: 16px; color: rgb(2, 2, 2);&quot;&gt;Yes&lt;/span&gt;</choiceText>
        <dataType>Boolean</dataType>
        <value>
            <booleanValue>true</booleanValue>
        </value>
    </choices>
    <choices>
        <name>Membership_Options_Single</name>
        <choiceText>&lt;span style=&quot;color: rgb(33, 37, 41); font-size: 16px;&quot;&gt;&lt;span class=&quot;ql-cursor&quot;&gt;﻿&lt;/span&gt;No&lt;/span&gt;</choiceText>
        <dataType>Boolean</dataType>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </choices>
    <choices>
        <name>No_Membership</name>
        <choiceText>&lt;b style=&quot;font-size: 16px; color: rgb(33, 37, 41);&quot;&gt;Continue without membership&lt;/b&gt;</choiceText>
        <dataType>String</dataType>
        <value>
            <elementReference>WITHOUT_MEMBERSHIP</elementReference>
        </value>
    </choices>
    <constants>
        <name>AMOUNT_48</name>
        <dataType>Currency</dataType>
        <value>
            <numberValue>48.0</numberValue>
        </value>
    </constants>
    <constants>
        <name>AMOUNT_57</name>
        <dataType>Currency</dataType>
        <value>
            <numberValue>57.0</numberValue>
        </value>
    </constants>
    <constants>
        <name>CARE_MEMBERSHIP</name>
        <dataType>String</dataType>
        <value>
            <stringValue>Care Membership</stringValue>
        </value>
    </constants>
    <constants>
        <name>CREDIT_CARD</name>
        <dataType>String</dataType>
        <value>
            <stringValue>CreditCard</stringValue>
        </value>
    </constants>
    <constants>
        <name>Credit_Card_Icon</name>
        <dataType>String</dataType>
        <value>
            <stringValue>&lt;img src=&apos;/resource/1571346494000/Credit_Card_Icon&apos;/&gt;</stringValue>
        </value>
    </constants>
    <constants>
        <description>E</description>
        <name>DD_NOT_AVAILABLE_MESSAGE</name>
        <dataType>String</dataType>
        <value>
            <stringValue>Unfortunately, direct debit membership payment is not available at this time. </stringValue>
        </value>
    </constants>
    <constants>
        <name>Debit_Credit_Icon</name>
        <dataType>String</dataType>
        <value>
            <stringValue>&lt;img src=&apos;/resource/1571348572000/Direct_Debit_Icon&apos;/&gt;</stringValue>
        </value>
    </constants>
    <constants>
        <name>GAD_JOINT</name>
        <dataType>String</dataType>
        <value>
            <stringValue>Joint</stringValue>
        </value>
    </constants>
    <constants>
        <name>Line_Image</name>
        <dataType>String</dataType>
        <value>
            <stringValue>&lt;img src=&apos;/resource/line&apos;/&gt;</stringValue>
        </value>
    </constants>
    <constants>
        <name>MEMBERSHIP_PAYMENT_OPTION_CC</name>
        <dataType>String</dataType>
        <value>
            <stringValue>CC</stringValue>
        </value>
    </constants>
    <constants>
        <name>MEMBERSHIP_PAYMENT_OPTION_DD</name>
        <dataType>String</dataType>
        <value>
            <stringValue>DD</stringValue>
        </value>
    </constants>
    <constants>
        <name>MEMBERSHIP_TYPE_A</name>
        <dataType>String</dataType>
        <value>
            <stringValue>A</stringValue>
        </value>
    </constants>
    <constants>
        <name>MEMBERSHIP_TYPE_E</name>
        <dataType>String</dataType>
        <value>
            <stringValue>E</stringValue>
        </value>
    </constants>
    <constants>
        <description>This is value for to get Product with Code Product &quot;Membership&quot; when client pay for membership by Credit Card(DD), Product must be created by method createStandartProduct which location in apex-script folder.</description>
        <name>PRODUCT_MEMBERSHIP_CC</name>
        <dataType>String</dataType>
        <value>
            <stringValue>Membership</stringValue>
        </value>
    </constants>
    <constants>
        <description>This is value for to get Product with Code Product &quot;Membership-CARE/DD&quot; when client pay for membership by Direct Debit(DD), Product must be created by method createStandartProduct which location in apex-script folder.</description>
        <name>PRODUCT_MEMBERSHIP_DD</name>
        <dataType>String</dataType>
        <value>
            <stringValue>Membership-CARE/DD</stringValue>
        </value>
    </constants>
    <constants>
        <name>TOAST_TYPE_ERROR</name>
        <dataType>String</dataType>
        <value>
            <stringValue>Error</stringValue>
        </value>
    </constants>
    <constants>
        <name>WITHOUT_MEMBERSHIP</name>
        <dataType>String</dataType>
        <value>
            <stringValue>No</stringValue>
        </value>
    </constants>
    <decisions>
        <name>Amount_Value</name>
        <label>Amount Value</label>
        <locationX>1478</locationX>
        <locationY>806</locationY>
        <defaultConnectorLabel>Without Membership</defaultConnectorLabel>
        <rules>
            <name>Is_Type_E</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Chosen_Membership_Result</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>MEMBERSHIP_TYPE_E</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Add_Membership_Type_and_Amount_to_Installment_2</targetReference>
            </connector>
            <label>Is Type E</label>
        </rules>
        <rules>
            <name>Is_Type_A</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Chosen_Membership_Result</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>MEMBERSHIP_TYPE_A</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Add_Membership_Type_and_Amount_to_Installment_1</targetReference>
            </connector>
            <label>Is Type A</label>
        </rules>
    </decisions>
    <decisions>
        <description>CC = Credit Card
We check this because if Membership is with Partner we will need to add Contact Partner Id to Installment record. And then formula field(ga_decl_1__c,ga_decl_2__c ) check has or not gift aid declaration via LookUp.</description>
        <name>Check_Membership_Options_CC</name>
        <label>Check Membership Options CC</label>
        <locationX>2810</locationX>
        <locationY>798</locationY>
        <defaultConnector>
            <targetReference>Type_Of_Payment</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Without Partner</defaultConnectorLabel>
        <rules>
            <name>With_Partner_CC</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Is_Membership_With_Partner</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Partner_Contact_Id_for_Installment</targetReference>
            </connector>
            <label>With Partner CC</label>
        </rules>
    </decisions>
    <decisions>
        <description>DD = Direct Debit
We check this because if Membership is with Partner we will need to add Contact Partner Id to Installment record. And then formula field(ga_decl_1__c,ga_decl_2__c ) check has or not gift aid declaration via LookUp.</description>
        <name>Check_Membership_Options_DD</name>
        <label>Check Membership Options DD</label>
        <locationX>2659</locationX>
        <locationY>326</locationY>
        <defaultConnector>
            <targetReference>Create_Membership_Installment</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Without Partner</defaultConnectorLabel>
        <rules>
            <name>With_Partner_DD</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Is_Membership_With_Partner</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Partner_Contact_Id_for_Installment_0</targetReference>
            </connector>
            <label>With Partner DD</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Banks_Number_True</name>
        <label>Is Banks Number True</label>
        <locationX>2029</locationX>
        <locationY>1812</locationY>
        <defaultConnector>
            <targetReference>DD_Not_Available</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Is False</defaultConnectorLabel>
        <rules>
            <name>Is_True</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>bankNumber</leftValueReference>
                <operator>NotEqualTo</operator>
            </conditions>
            <connector>
                <targetReference>Set_Data_for_SI_Line_Items_DD</targetReference>
            </connector>
            <label>Is True</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Membership_Chose</name>
        <label>Is Membership Chose ?</label>
        <locationX>1477</locationX>
        <locationY>524</locationY>
        <defaultConnector>
            <targetReference>Clear_Gift_Aid_Declaration_Filed_on_Booking_Object</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Membership Is False</defaultConnectorLabel>
        <rules>
            <name>Membership_Is_True</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Chosen_Membership_Result</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>No</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Amount_Value</targetReference>
            </connector>
            <label>Membership Is True</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Membership_Chose_0</name>
        <label>Is Membership Chose ?</label>
        <locationX>2661</locationX>
        <locationY>676</locationY>
        <defaultConnector>
            <targetReference>Type_Of_Payment</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Membership Is False</defaultConnectorLabel>
        <rules>
            <name>Membership_Is_True_and_CC</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Chosen_Membership_Result</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>WITHOUT_MEMBERSHIP</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Membership_Payment_Options</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>MEMBERSHIP_PAYMENT_OPTION_CC</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Add_Cost_Membership</targetReference>
            </connector>
            <label>Membership Is True and CC</label>
        </rules>
        <rules>
            <name>Membership_Is_True_and_DD</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Chosen_Membership_Result</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <elementReference>WITHOUT_MEMBERSHIP</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Membership_Payment_Options</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>MEMBERSHIP_PAYMENT_OPTION_DD</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Populate_Fields_of_Installment_Object_With_Bank_Number</targetReference>
            </connector>
            <label>Membership Is True and DD</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_SI_is_Null</name>
        <label>Is SI is Null</label>
        <locationX>2477</locationX>
        <locationY>774</locationY>
        <defaultConnector>
            <targetReference>Is_Membership_Chose_0</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Is Not Null</defaultConnectorLabel>
        <rules>
            <name>Is_Null</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Create_SI_and_SI_Line_Items</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Error_Handler_SubFlow</targetReference>
            </connector>
            <label>Is Null</label>
        </rules>
    </decisions>
    <decisions>
        <name>Payment_Link_Result</name>
        <label>Payment Link Result</label>
        <locationX>3391</locationX>
        <locationY>667</locationY>
        <defaultConnector>
            <targetReference>Payment_Error_Screen</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Payment Link is False</defaultConnectorLabel>
        <rules>
            <name>Payment_Link_is_True</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>paymentUrl</leftValueReference>
                <operator>NotEqualTo</operator>
            </conditions>
            <connector>
                <targetReference>Add_Amount_To_Be_Paid</targetReference>
            </connector>
            <label>Payment Link is True</label>
        </rules>
    </decisions>
    <decisions>
        <name>Payment_Method_Decision</name>
        <label>Payment Method Decision</label>
        <locationX>1027</locationX>
        <locationY>372</locationY>
        <defaultConnectorLabel>Without Membership</defaultConnectorLabel>
        <rules>
            <name>Pay_Only_for_Course</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Course_Payment_Type</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>CourseCC</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Added_Course_Payment_By_Credit_Card</targetReference>
            </connector>
            <label>Pay Only for Course</label>
        </rules>
        <rules>
            <name>Pay_Only_for_Course_Plan</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Course_Payment_Type</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>CoursePlanCC</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Course_Plan_Payment_By_Credit_Card</targetReference>
            </connector>
            <label>Pay Only for Course Plan</label>
        </rules>
    </decisions>
    <decisions>
        <name>Payment_Method_Decision_0</name>
        <label>Payment Method Decision</label>
        <locationX>1492</locationX>
        <locationY>1292</locationY>
        <defaultConnectorLabel>Without Membership</defaultConnectorLabel>
        <rules>
            <name>Membership_by_Credit_Card_0</name>
            <conditionLogic>1 AND (2 OR 3)</conditionLogic>
            <conditions>
                <leftValueReference>Membership_Payment_Options</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>MEMBERSHIP_PAYMENT_OPTION_CC</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Course_Payment_Type</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>CourseCC</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Course_Payment_Type</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>CoursePlanCC</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Membership_Data_for_Installment_By_CC</targetReference>
            </connector>
            <label>Membership by Credit Card</label>
        </rules>
        <rules>
            <name>Membership_by_Direct_Debit_0</name>
            <conditionLogic>1 AND (2 OR 3)</conditionLogic>
            <conditions>
                <leftValueReference>Membership_Payment_Options</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>MEMBERSHIP_PAYMENT_OPTION_DD</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Course_Payment_Type</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>CourseCC</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Course_Payment_Type</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>CoursePlanCC</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Direct_Debit_Bank_Account_Details_Screen</targetReference>
            </connector>
            <label>Membership by Direct Debit</label>
        </rules>
    </decisions>
    <decisions>
        <name>Type_Of_Payment</name>
        <label>Type Of Payment</label>
        <locationX>3000</locationX>
        <locationY>687</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Payment_Only_For_Course</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Payment_Method</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>CREDIT_CARD</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Is_Payment_Plan_True</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Card_Payment_Handler</targetReference>
            </connector>
            <label>Payment Only For Course</label>
        </rules>
        <rules>
            <name>Payment_Plan_For_Course</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Payment_Method</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>CREDIT_CARD</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Is_Payment_Plan_True</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Card_Payment_Plan_Handler</targetReference>
            </connector>
            <label>Payment Plan For Course</label>
        </rules>
    </decisions>
    <description>v.1.1 Process where:
1. Membership Options
2. Payment Options(Credit Card, Direct Debit).
3. Gift Aid Declaration Options
4. Create a Sales Invoice(Api)
5. Add Bank Details(Api)
6. Get Payment Link.</description>
    <formulas>
        <name>Amount_To_Be_Paid</name>
        <dataType>String</dataType>
        <expression>IF({!Is_Payment_Plan_True}, {!PaymentPlanOptionSelected.displayLabel}, &apos;One-off payment of £&apos; + TEXT({!Course_Fee}))</expression>
    </formulas>
    <formulas>
        <description>Return sum course fee for a one-off payment or payment plan + membership fee</description>
        <name>Course_Fee_With_Membership_Fee</name>
        <dataType>Currency</dataType>
        <expression>IF({!Is_Payment_Plan_True} == true, {!PaymentPlanParameters.amount} + {!AMOUNT_48}, {!Course_Fee} + {!AMOUNT_48})</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <name>ERROR_PAGE</name>
        <dataType>String</dataType>
        <expression>{!$Setup.Parentforce_Community_Settings__c.Base_Url__c}+&apos;/s/failure&apos;</expression>
    </formulas>
    <formulas>
        <name>Get_Course_Fee</name>
        <dataType>Currency</dataType>
        <expression>IF({!bookingRecord.Fee_Override__c} &gt; 0, {!bookingRecord.Fee_Override__c}, {!bookingRecord.Course_Fee__c})</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <name>SUCCESS_PAGE</name>
        <dataType>String</dataType>
        <expression>{!$Setup.Parentforce_Community_Settings__c.Base_Url__c}+&apos;/s/success/?bookingId=&apos;+{!bookingId}</expression>
    </formulas>
    <interviewLabel>Booking Main Payment Process {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Booking Main Payment Process</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>Flow</processType>
    <recordCreates>
        <name>Create_Membership_Installment</name>
        <label>Create Membership Installment</label>
        <locationX>2912</locationX>
        <locationY>516</locationY>
        <connector>
            <targetReference>Type_Of_Payment</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Error_Handler_SubFlow</targetReference>
        </faultConnector>
        <inputReference>Installment_For_Payment_By_DD</inputReference>
    </recordCreates>
    <recordLookups>
        <name>Get_Booking</name>
        <label>Get Booking</label>
        <locationX>512</locationX>
        <locationY>202</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Booking_Membership_Options_Flow</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Error_Handler_SubFlow</targetReference>
        </faultConnector>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>bookingId</elementReference>
            </value>
        </filters>
        <object>Booking__c</object>
        <outputReference>bookingRecord</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>Partner_Contact__c</queriedFields>
        <queriedFields>Primary_Contact__c</queriedFields>
        <queriedFields>NCT_Number__c</queriedFields>
        <queriedFields>NCT_Number_Partner__c</queriedFields>
        <queriedFields>First_Name__c</queriedFields>
        <queriedFields>Street_Address__c</queriedFields>
        <queriedFields>Postcode__c</queriedFields>
        <queriedFields>Course_Fee__c</queriedFields>
        <queriedFields>Fee_Override__c</queriedFields>
        <queriedFields>Course_Start_Date__c</queriedFields>
        <queriedFields>Course_Sub_Type__c</queriedFields>
        <queriedFields>PSA_Office__c</queriedFields>
        <queriedFields>Course__c</queriedFields>
    </recordLookups>
    <recordLookups>
        <name>Get_Course_Nominal_Account</name>
        <label>Get Course Nominal Account</label>
        <locationX>1741</locationX>
        <locationY>871</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_Course_Place</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Error_Handler_SubFlow</targetReference>
        </faultConnector>
        <filters>
            <field>Zumzum__Nominal_Code__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>1400</stringValue>
            </value>
        </filters>
        <object>Zumzum__Nominal_Account__c</object>
        <outputReference>CourseNominalAccount</outputReference>
        <queriedFields>Id</queriedFields>
    </recordLookups>
    <recordLookups>
        <name>Get_Course_Place</name>
        <label>Get Course Place</label>
        <locationX>1851</locationX>
        <locationY>676</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Course_ZumzumSalesInvoiceParameter_Assignment</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Error_Handler_SubFlow</targetReference>
        </faultConnector>
        <filters>
            <field>Name</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Course Place</stringValue>
            </value>
        </filters>
        <object>Product2</object>
        <outputReference>CoursePlace</outputReference>
        <queriedFields>Id</queriedFields>
    </recordLookups>
    <recordLookups>
        <name>Get_GBP</name>
        <label>Get GBP</label>
        <locationX>1847</locationX>
        <locationY>515</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Is_Membership_Chose</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Error_Handler_SubFlow</targetReference>
        </faultConnector>
        <filters>
            <field>Name</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>GBP</stringValue>
            </value>
        </filters>
        <object>Zumzum__Currency__c</object>
        <outputReference>GBP</outputReference>
        <queriedFields>Id</queriedFields>
    </recordLookups>
    <recordLookups>
        <name>Get_Membership_Nominal_Account</name>
        <label>Get Membership Nominal Account</label>
        <locationX>1812</locationX>
        <locationY>1566</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_Product_For_Membership</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Error_Handler_SubFlow</targetReference>
        </faultConnector>
        <filters>
            <field>Zumzum__Nominal_Code__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>1003</stringValue>
            </value>
        </filters>
        <object>Zumzum__Nominal_Account__c</object>
        <outputReference>MembershipNominalAccount</outputReference>
        <queriedFields>Id</queriedFields>
    </recordLookups>
    <recordLookups>
        <name>Get_No_VAT</name>
        <label>Get No VAT</label>
        <locationX>2037</locationX>
        <locationY>508</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_GBP</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Error_Handler_SubFlow</targetReference>
        </faultConnector>
        <filters>
            <field>Zumzum__Active__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>Zumzum__Type__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Non-Vatable</stringValue>
            </value>
        </filters>
        <filters>
            <field>Zumzum__is_no_tax__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <object>Zumzum__Tax_Rate__c</object>
        <outputReference>No_VAT</outputReference>
        <queriedFields>Id</queriedFields>
    </recordLookups>
    <recordLookups>
        <name>Get_Primary_Contact</name>
        <label>Get Primary Contact</label>
        <locationX>1847</locationX>
        <locationY>361</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_No_VAT</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Error_Handler_SubFlow</targetReference>
        </faultConnector>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>bookingRecord.Primary_Contact__c</elementReference>
            </value>
        </filters>
        <object>Contact</object>
        <outputReference>Primary_Contact</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>AccountId</queriedFields>
    </recordLookups>
    <recordLookups>
        <name>Get_Product_For_Membership</name>
        <label>Get Product For Membership</label>
        <locationX>1743</locationX>
        <locationY>1273</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Membership_ZumzumSalesInvoiceParameter_Assignment</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Error_Handler_SubFlow</targetReference>
        </faultConnector>
        <filters>
            <field>ProductCode</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Type_Of_Product_for_Membership</elementReference>
            </value>
        </filters>
        <object>Product2</object>
        <outputReference>Membership_Product_Record</outputReference>
        <queriedFields>Id</queriedFields>
    </recordLookups>
    <recordUpdates>
        <description>What update:
1. Booking Journey Amount To Be Paid( e.g One-off payment of £780);
2. Next Collection Date;
3. Gift Aid Declaration(Single or Joint Gift Aid Declaration);</description>
        <name>Update_Booking_Record</name>
        <label>Update Booking Record</label>
        <locationX>3738</locationX>
        <locationY>916</locationY>
        <connector>
            <targetReference>Set_Total_Amount</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Error_Handler_SubFlow</targetReference>
        </faultConnector>
        <inputReference>Booking_Instance_For_Update</inputReference>
    </recordUpdates>
    <runInMode>SystemModeWithoutSharing</runInMode>
    <screens>
        <name>Direct_Debit_Bank_Account_Details_Screen</name>
        <label>Direct Debit Bank Account Details Screen</label>
        <locationX>1188</locationX>
        <locationY>1293</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Populate_Fields_of_Installment_Object_For_Membership</targetReference>
        </connector>
        <fields>
            <name>Direct_Debit_Guarantee_Text</name>
            <fieldText>&lt;p&gt;&lt;span style=&quot;font-size: 26px;&quot;&gt;The Direct Debit Guarantee&lt;/span&gt;&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;span style=&quot;font-size: 14px; background-color: rgb(255, 255, 255);&quot;&gt;This Guarantee is offered by all banks and building societies that accept instructions to pay Direct Debits.&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 14px; background-color: rgb(255, 255, 255);&quot;&gt;If there are any changes to the amount, date or frequency of your Direct Debit NCT will notify you 10 working days in advance of your account being debited or as otherwise agreed. If you request NCT to collect a payment, confirmation of the amount and date will be given to you at the time of the request.&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 14px; background-color: rgb(255, 255, 255);&quot;&gt;If an error is made in the payment of your Direct Debit, by NCT or your bank or building society, you are entitled to a full and immediate refund of the amount paid from your bank or building society.&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 14px; background-color: rgb(255, 255, 255);&quot;&gt;If you receive a refund you are not entitled to, you must pay it back when NCT asks you to.&lt;/span&gt;&lt;/li&gt;&lt;li&gt;&lt;span style=&quot;font-size: 14px; background-color: rgb(255, 255, 255);&quot;&gt;﻿You can cancel a Direct Debit at any time by simply contacting your bank or building society. Written confirmation may be required. Please also notify us.&lt;/span&gt;&lt;/li&gt;&lt;/ul&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Direct_Debit_Bank_Account_Details_Text</name>
            <fieldText>&lt;p&gt;&lt;span style=&quot;font-size: 26px;&quot;&gt;Direct debit details&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;If you are not the account holder or bank account requires more than one signatory then please ask our Enquiries team to send you a paper Direct Debit Instruction.&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Account_Name</name>
            <dataType>String</dataType>
            <fieldText>Account Name</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
            <validationRule>
                <errorMessage>&lt;p&gt;Please be sure that Account Name not more than 80 characters and is text.&lt;/p&gt;</errorMessage>
                <formulaExpression>AND(
LEN({!Account_Name}) &lt; 80,
NOT(ISNUMBER({!Account_Name}))
)</formulaExpression>
            </validationRule>
        </fields>
        <fields>
            <name>Account_Number</name>
            <dataType>String</dataType>
            <fieldText>Account Number</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
            <validationRule>
                <errorMessage>&lt;p&gt;Please make sure that the Bank Account Number consists of 8 digits and is numeric&amp;nbsp;e.g &apos;12345678&apos;.&lt;/p&gt;</errorMessage>
                <formulaExpression>AND (
 LEN({!Account_Number}) == 8, 
 ISNUMBER({!Account_Number})
)</formulaExpression>
            </validationRule>
        </fields>
        <fields>
            <name>Sort_Code</name>
            <dataType>String</dataType>
            <fieldText>Sort Code</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
            <validationRule>
                <errorMessage>&lt;p&gt;Please make sure that the Sort Code consists of 6 digits and is numeric&amp;nbsp;e.g &apos;123456&apos;.&lt;/p&gt;</errorMessage>
                <formulaExpression>AND (
  LEN({!Sort_Code}) == 6, 
   ISNUMBER({!Sort_Code})
)</formulaExpression>
            </validationRule>
        </fields>
        <fields>
            <name>Payment_Date_Text</name>
            <fieldText>&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b style=&quot;font-size: 14px;&quot;&gt;Payment date&lt;/b&gt;&lt;/p&gt;&lt;p&gt;3rd of the month&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Empty_Row</name>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Direct_Debit_Confirm_Text</name>
            <dataType>Boolean</dataType>
            <fieldText>I confirm that I&apos;m authorised to debit from this account. I agree to NCT debiting my account as detailed above.</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
            <validationRule>
                <errorMessage>&lt;p&gt;Before you can continue, please indicate you have read and agreed to the terms and conditions&lt;/p&gt;</errorMessage>
                <formulaExpression>IF({!Direct_Debit_Confirm_Text} == TRUE, TRUE, FALSE)</formulaExpression>
            </validationRule>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Payment_Details_Screen</name>
        <label>Payment Details Screen</label>
        <locationX>3926</locationX>
        <locationY>776</locationY>
        <allowBack>true</allowBack>
        <allowFinish>false</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>Payment_Details_Info</name>
            <fieldText>&lt;p&gt;&lt;span style=&quot;font-size: 36px;&quot;&gt;Pay by credit/debit card&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;To pay by credit or debit card using the secure Worldpay system, please select &apos;Proceed to payment&apos;. You&apos;ll be redirected to the Worldpay site to complete your payment.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;We don&apos;t see or store any of your debit or credit card information.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;font-size: 18px;&quot;&gt;Please note: Credit cards levy higher charges on us than debit cards. We&apos;d be grateful to you for supporting our charity by using a debit card if possible.&lt;/span&gt;&lt;/p&gt;&lt;h4&gt;&lt;br&gt;&lt;/h4&gt;&lt;p style=&quot;text-align: center;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Total_Amount_Template_Message</name>
            <fieldText>&lt;p&gt;{!Total_Amount_Template}&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Payment_Link_Component</name>
            <extensionName>c:linkToPaymentComponent</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>paymentLink</name>
                <value>
                    <elementReference>paymentUrl</elementReference>
                </value>
            </inputParameters>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Payment_Error_Screen</name>
        <label>Payment Error Screen</label>
        <locationX>3559</locationX>
        <locationY>467</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>Payment_Error_Message</name>
            <fieldText>&lt;p&gt;{!paymentError}&lt;/p&gt;&lt;p&gt;{!$Flow.FaultMessage}&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <screens>
        <name>Payment_Options_Screen</name>
        <label>Payment Options Screen</label>
        <locationX>909</locationX>
        <locationY>660</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <connector>
            <targetReference>Payment_Method_Decision</targetReference>
        </connector>
        <fields>
            <name>Pay_For_Courses</name>
            <fieldText>&lt;p&gt;&lt;span style=&quot;font-size: 28px; color: rgb(33, 37, 41);&quot;&gt;Payment options&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;color: rgb(33, 37, 41);&quot;&gt;{!Line_Image}&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;color: rgb(0, 135, 106); font-size: 20px;&quot;&gt;How would you like to pay for your course?﻿&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Course_Payment_Options</name>
            <choiceReferences>Debit_and_Credit_Card_Course</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Pay Options</fieldText>
            <fieldType>RadioButtons</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>Course_Payment_Type</name>
            <choiceReferences>CourseCC</choiceReferences>
            <choiceReferences>CoursePlanCC</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Course Payment Type</fieldText>
            <fieldType>RadioButtons</fieldType>
            <isRequired>true</isRequired>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>Course_Payment_Options</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>CC</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>PaymentOptionsComponent</name>
            <extensionName>c:paymentPlanOptions</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>courseFee</name>
                <value>
                    <elementReference>Course_Fee</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>courseStartDate</name>
                <value>
                    <elementReference>bookingRecord.Course_Start_Date__c</elementReference>
                </value>
            </inputParameters>
            <isRequired>true</isRequired>
            <outputParameters>
                <assignToReference>PaymentPlanOptionSelected</assignToReference>
                <name>paymentPlanOptionSelected</name>
            </outputParameters>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>Course_Payment_Type</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <elementReference>CoursePlanCC</elementReference>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>Pay_For_Membership</name>
            <fieldText>&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;color: rgb(33, 37, 41); background-color: rgb(255, 255, 255);&quot;&gt;{!Line_Image}&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;color: rgb(0, 135, 106); background-color: rgb(255, 255, 255);&quot;&gt;﻿&lt;/span&gt;&lt;span style=&quot;color: rgb(0, 135, 106); background-color: rgb(255, 255, 255); font-size: 20px;&quot;&gt;How would you like to pay for your NCT membership?&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>Chosen_Membership_Result</leftValueReference>
                    <operator>NotEqualTo</operator>
                    <rightValue>
                        <elementReference>WITHOUT_MEMBERSHIP</elementReference>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>Membership_Payment_Options</name>
            <choiceReferences>Debit_and_Credit_Card_Membership</choiceReferences>
            <choiceReferences>Direct_Debit_Membership</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Pay Options</fieldText>
            <fieldType>RadioButtons</fieldType>
            <isRequired>true</isRequired>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>Chosen_Membership_Result</leftValueReference>
                    <operator>NotEqualTo</operator>
                    <rightValue>
                        <elementReference>WITHOUT_MEMBERSHIP</elementReference>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>One_off_payment_57</name>
            <choiceReferences>Membership_One_off_Payment_57</choiceReferences>
            <dataType>String</dataType>
            <fieldText>One-off payment</fieldText>
            <fieldType>RadioButtons</fieldType>
            <isRequired>true</isRequired>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>Chosen_Membership_Result</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>E</stringValue>
                    </rightValue>
                </conditions>
                <conditions>
                    <leftValueReference>Membership_Payment_Options</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>CC</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>One_off_payment_48</name>
            <choiceReferences>Membership_One_off_Payment_48</choiceReferences>
            <dataType>String</dataType>
            <fieldText>One-off payment</fieldText>
            <fieldType>RadioButtons</fieldType>
            <isRequired>true</isRequired>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>Chosen_Membership_Result</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>A</stringValue>
                    </rightValue>
                </conditions>
                <conditions>
                    <leftValueReference>Membership_Payment_Options</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>CC</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>Direct_debit_payment_57</name>
            <choiceReferences>DD_57_Every_18_Month</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Direct debit payment</fieldText>
            <fieldType>RadioButtons</fieldType>
            <isRequired>true</isRequired>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>Chosen_Membership_Result</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>E</stringValue>
                    </rightValue>
                </conditions>
                <conditions>
                    <leftValueReference>Membership_Payment_Options</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>DD</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>Direct_debit_payment_48</name>
            <choiceReferences>DD_48_Every_12_Month</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Direct debit payment</fieldText>
            <fieldType>RadioButtons</fieldType>
            <isRequired>true</isRequired>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>Chosen_Membership_Result</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>A</stringValue>
                    </rightValue>
                </conditions>
                <conditions>
                    <leftValueReference>Membership_Payment_Options</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>DD</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>false</showHeader>
    </screens>
    <start>
        <locationX>123</locationX>
        <locationY>182</locationY>
        <connector>
            <targetReference>Get_Booking</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <subflows>
        <name>Booking_Gift_Aid_Declaration_Flow</name>
        <label>Booking Gift Aid Declaration Flow</label>
        <locationX>1967</locationX>
        <locationY>863</locationY>
        <connector>
            <targetReference>Get_Course_Nominal_Account</targetReference>
        </connector>
        <flowName>Booking_Gift_Aid_Declaration</flowName>
        <inputAssignments>
            <name>BookingRecord</name>
            <value>
                <elementReference>bookingRecord</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>Is_Membership_With_Partner</name>
            <value>
                <elementReference>Is_Membership_With_Partner</elementReference>
            </value>
        </inputAssignments>
        <outputAssignments>
            <assignToReference>Booking_Instance_For_Update.Gift_Aid_Declaration_Status__c</assignToReference>
            <name>Gift_Aid_Result</name>
        </outputAssignments>
    </subflows>
    <subflows>
        <name>Booking_Membership_Options_Flow</name>
        <label>Booking Membership Options Flow</label>
        <locationX>578</locationX>
        <locationY>368</locationY>
        <connector>
            <targetReference>Get_Course_Fee_Assigment</targetReference>
        </connector>
        <flowName>Booking_Membership_Options</flowName>
        <inputAssignments>
            <name>bookingRecord</name>
            <value>
                <elementReference>bookingRecord</elementReference>
            </value>
        </inputAssignments>
        <outputAssignments>
            <assignToReference>Chosen_Membership_Result</assignToReference>
            <name>Chosen_Membership_Result</name>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>Is_Membership_With_Partner</assignToReference>
            <name>Is_Membership_With_Partner</name>
        </outputAssignments>
    </subflows>
    <subflows>
        <name>Checking_NCT_Number_on_Contact</name>
        <label>Checking NCT Number on Contact</label>
        <locationX>766</locationX>
        <locationY>366</locationY>
        <connector>
            <targetReference>Payment_Options_Screen</targetReference>
        </connector>
        <flowName>Checking_NCT_Number_on_Contact</flowName>
        <inputAssignments>
            <name>Membership_With_Partner</name>
            <value>
                <elementReference>Is_Membership_With_Partner</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>Booking_Record</name>
            <value>
                <elementReference>bookingRecord</elementReference>
            </value>
        </inputAssignments>
    </subflows>
    <subflows>
        <name>Error_Handler_SubFlow</name>
        <label>Error Handler SubFlow</label>
        <locationX>2413</locationX>
        <locationY>1430</locationY>
        <flowName>Error_Handler_Flow</flowName>
    </subflows>
    <textTemplates>
        <name>Membership_12_Template</name>
        <text>&lt;b style=&quot;font-size: 16px;&quot;&gt;12 &lt;/b&gt;&lt;b style=&quot;font-size: 16px; color: #212529; background-color: rgb(255, 255, 255);&quot;&gt;month membership&lt;/b&gt; &lt;p style=&quot;margin-left:24px;&quot;&gt;12 months money off baby supplies, holidays and services when you help us continue being the leading charity for pregnancy and young families. &lt;b style=&quot;color:#212529;&quot;&gt;£48&lt;/b&gt;&amp;nbsp;(or £12 per quarter)&lt;/p&gt;</text>
    </textTemplates>
    <textTemplates>
        <name>Membership_18_Template</name>
        <text>&lt;b style=&quot;font-size: 16px; color:#212529;&quot;&gt;18 month memberships&lt;/b&gt;&lt;p style=&quot;margin-left:24px;&quot;&gt;18 months money off baby supplies, holidays and services when you help us continue being the leading charity for pregnancy and young families. &lt;b style=&quot;color:#212529;&quot;&gt;£57&lt;/b&gt;&amp;nbsp;(or £9.50 per quarter)&lt;/p&gt;</text>
    </textTemplates>
    <textTemplates>
        <name>Membership_Options_Add_Partner_Label</name>
        <text>Would you like to add partner?</text>
    </textTemplates>
    <textTemplates>
        <name>Total_Amount_Template</name>
        <text>&lt;p&gt;&lt;span style=&quot;font-size: 22px; background-color: rgb(255, 255, 255); color: rgb(62, 62, 60);&quot;&gt;Total amount due:&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(62, 62, 60);&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(62, 62, 60); font-size: 22px;&quot;&gt;{!Total_Fee}&lt;/span&gt;&lt;/p&gt;</text>
    </textTemplates>
    <variables>
        <name>bankNumber</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>bankNumberError</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>Booking_Instance_For_Update</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Booking__c</objectType>
    </variables>
    <variables>
        <name>bookingId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>bookingRecord</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <objectType>Booking__c</objectType>
    </variables>
    <variables>
        <name>Chosen_Membership_Result</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>Course_Fee</name>
        <dataType>Currency</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>2</scale>
    </variables>
    <variables>
        <name>CourseNominalAccount</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Zumzum__Nominal_Account__c</objectType>
    </variables>
    <variables>
        <name>CoursePlace</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Product2</objectType>
    </variables>
    <variables>
        <name>CourseZumzumSalesInvoiceParameter</name>
        <apexClass>ZumzumSalesInvoiceParameters</apexClass>
        <dataType>Apex</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>GBP</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Zumzum__Currency__c</objectType>
    </variables>
    <variables>
        <name>Gift_Aid_Declaration_List</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>gaid__Gift_Aid_Declaration__c</objectType>
    </variables>
    <variables>
        <name>Gift_Aid_Declaration_Status</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <description>DD = Direct Debit</description>
        <name>Installment_For_Payment_By_DD</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>cpm__Installment__c</objectType>
    </variables>
    <variables>
        <name>Is_Membership_With_Partner</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </variables>
    <variables>
        <name>Is_Payment_Plan_True</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </variables>
    <variables>
        <name>Membership_Amount</name>
        <dataType>Currency</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>2</scale>
    </variables>
    <variables>
        <name>Membership_PriceBook</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Pricebook2</objectType>
    </variables>
    <variables>
        <name>Membership_Product_Record</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Product2</objectType>
    </variables>
    <variables>
        <name>Membership_Sales_Invoice_Amount</name>
        <dataType>Currency</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>2</scale>
    </variables>
    <variables>
        <name>MembershipNominalAccount</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Zumzum__Nominal_Account__c</objectType>
    </variables>
    <variables>
        <name>MembershipZumzumSalesInvoiceParameter</name>
        <apexClass>ZumzumSalesInvoiceParameters</apexClass>
        <dataType>Apex</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>No_VAT</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Zumzum__Tax_Rate__c</objectType>
    </variables>
    <variables>
        <name>Payment_Method</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>paymentError</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>PaymentPlanOptionSelected</name>
        <apexClass>PaymentPlanOption</apexClass>
        <dataType>Apex</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>PaymentPlanParameters</name>
        <apexClass>CardPaymentParameters</apexClass>
        <dataType>Apex</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>PaymentProfileId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>paymentUrl</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>PriceBook_Entry</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>PricebookEntry</objectType>
    </variables>
    <variables>
        <name>Primary_Contact</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Contact</objectType>
    </variables>
    <variables>
        <description>This variable will display in the Payment Detail Screen</description>
        <name>Total_Fee</name>
        <dataType>Currency</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>2</scale>
    </variables>
    <variables>
        <name>Type_Of_Product_for_Membership</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>WithPartner</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </variables>
    <variables>
        <name>ZumzumSalesInvoiceParametersList</name>
        <apexClass>ZumzumSalesInvoiceParameters</apexClass>
        <dataType>Apex</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
